<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>教师仪表盘 - Schedule Widget</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/teacher-dashboard.css">
</head>

<body>
    <div class="dashboard-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <span class="material-icons-round logo-icon">schedule</span>
                    <span class="logo-text">Schedule</span>
                </div>
                <button class="sidebar-toggle-mobile btn ghost-btn">
                    <span class="material-icons-round">close</span>
                </button>
            </div>

            <nav class="nav-menu">
                <a href="#" class="nav-item active" data-section="overview">
                    <span class="material-icons-round">dashboard</span>
                    <span class="nav-text">总览</span>
                </a>
                <a href="#" class="nav-item" data-section="profile">
                    <span class="material-icons-round">person</span>
                    <span class="nav-text">个人信息</span>
                </a>
                <a href="#" class="nav-item" data-section="availability">
                    <span class="material-icons-round">event_available</span>
                    <span class="nav-text">时间安排</span>
                </a>
                <a href="#" class="nav-item" data-section="schedules">
                    <span class="material-icons-round">calendar_today</span>
                    <span class="nav-text">课程安排</span>
                </a>
                <a href="#" class="nav-item" data-section="teaching-display">
                    <span class="material-icons-round">analytics</span>
                    <span class="nav-text">数据统计</span>
                </a>
            </nav>

            <div class="sidebar-footer">
                <button class="sidebar-collapse-btn btn ghost-btn">
                    <span class="material-icons-round">chevron_left</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="top-bar">
                <div class="flex items-center gap-4">
                    <button class="mobile-menu-btn btn ghost-btn">
                        <span class="material-icons-round">menu</span>
                    </button>
                    <h2 id="pageTitle" class="page-title">仪表盘</h2>
                </div>

                <div class="user-menu">
                    <div class="user-info">
                        <span class="user-name" id="teacherName">教师</span>
                        <span class="user-role badge">教师</span>
                    </div>
                    <button class="btn secondary-btn btn-sm" id="logout">
                        <span class="material-icons-round">logout</span>
                        退出
                    </button>
                </div>
            </header>

            <div class="content-area">
                <!-- Overview Section -->
                <section id="overview" class="dashboard-section active animate-fade-in">
                    <div class="stats-grid">
                        <div class="card stat-card primary">
                            <div class="stat-icon">
                                <span class="material-icons-round">class</span>
                            </div>
                            <div class="stat-info">
                                <h3>本月课程</h3>
                                <p class="stat-value" id="monthlyLessons">--</p>
                            </div>
                        </div>
                        <div class="card stat-card warning">
                            <div class="stat-icon">
                                <span class="material-icons-round">pending_actions</span>
                            </div>
                            <div class="stat-info">
                                <h3>待确认</h3>
                                <p class="stat-value" id="pendingConfirmations">--</p>
                            </div>
                        </div>
                        <div class="card stat-card success">
                            <div class="stat-icon">
                                <span class="material-icons-round">check_circle</span>
                            </div>
                            <div class="stat-info">
                                <h3>已完成</h3>
                                <p class="stat-value" id="completedLessons">--</p>
                            </div>
                        </div>
                    </div>

                    <div class="card mt-4">
                        <div class="card-header flex justify-between items-center mb-4">
                            <h3>今日排课</h3>
                            <button id="refreshTodaySchedulesBtn" class="btn ghost-btn">
                                <span class="material-icons-round">refresh</span>
                                刷新
                            </button>
                        </div>
                        <div class="today-schedule-list" id="todayScheduleList">
                            <!-- Dynamic Content -->
                        </div>
                    </div>
                </section>

                <!-- Profile Section -->
                <section id="profile" class="dashboard-section animate-fade-in">
                    <div class="profile-layout">
                        <div class="card profile-summary">
                            <div class="profile-avatar" id="profileAvatar">T</div>
                            <h3 class="text-center mt-4" id="profileSummaryTitle">教师姓名</h3>
                            <p class="text-center text-gray-500">教师账号</p>

                            <div class="profile-meta mt-4">
                                <div class="meta-item">
                                    <span class="label">上次登录</span>
                                    <span class="value" id="lastLoginDisplay">--</span>
                                </div>
                                <div class="meta-item">
                                    <span class="label">状态</span>
                                    <span class="value" id="statusDisplay">--</span>
                                </div>
                            </div>
                        </div>

                        <div class="card profile-details">
                            <div class="flex justify-between items-center mb-4">
                                <h3>详细信息</h3>
                                <div class="action-buttons">
                                    <button id="profileEditBtn" class="btn secondary-btn">编辑</button>
                                    <button id="profileCancelBtn" class="btn ghost-btn hidden">取消</button>
                                    <button id="profileSaveBtn" class="btn primary-btn hidden">保存</button>
                                </div>
                            </div>

                            <form id="profileForm" class="grid-form">
                                <div class="form-group">
                                    <label>姓名</label>
                                    <input type="text" id="profileNameInput" name="name" disabled>
                                </div>
                                <div class="form-group">
                                    <label>职业</label>
                                    <input type="text" id="profileProfessionInput" name="profession" disabled>
                                </div>
                                <div class="form-group">
                                    <label>联系方式</label>
                                    <input type="text" id="profileContactInput" name="contact" disabled>
                                </div>
                                <div class="form-group">
                                    <label>上班地点</label>
                                    <input type="text" id="profileWorkLocationInput" name="work_location" disabled>
                                </div>
                                <div class="form-group full-width">
                                    <label>住址</label>
                                    <input type="text" id="profileHomeAddressInput" name="home_address" disabled>
                                </div>
                            </form>
                        </div>
                    </div>
                </section>

                <!-- Availability Section -->
                <section id="availability" class="dashboard-section animate-fade-in">
                    <div class="card">
                        <div class="section-header flex justify-between items-center mb-4 flex-wrap gap-4">
                            <div class="week-navigation flex items-center gap-2">
                                <button id="prevWeekAvail" class="btn ghost-btn icon-only"><span
                                        class="material-icons-round">chevron_left</span></button>
                                <span id="weekRangeAvail" class="font-medium">加载中...</span>
                                <button id="nextWeekAvail" class="btn ghost-btn icon-only"><span
                                        class="material-icons-round">chevron_right</span></button>
                            </div>
                            <button class="btn primary-btn" id="saveAvailability">
                                <span class="material-icons-round">save</span>
                                保存更改
                            </button>
                        </div>

                        <div class="table-responsive">
                            <table class="weekly-schedule-table">
                                <thead id="weeklyHeaderAvail"></thead>
                                <tbody id="weeklyBodyAvail"></tbody>
                            </table>
                        </div>
                        <div id="availabilityFeedback" class="feedback-message mt-2"></div>
                    </div>
                </section>

                <!-- Schedules Section -->
                <section id="schedules" class="dashboard-section animate-fade-in">
                    <div class="card">
                        <div class="section-header flex justify-between items-center mb-4">
                            <div class="week-navigation flex items-center gap-2">
                                <button id="prevWeek" class="btn ghost-btn icon-only"><span
                                        class="material-icons-round">chevron_left</span></button>
                                <span id="weekRange" class="font-medium">加载中...</span>
                                <button id="nextWeek" class="btn ghost-btn icon-only"><span
                                        class="material-icons-round">chevron_right</span></button>
                            </div>
                        </div>

                        <div class="table-responsive">
                            <table class="weekly-schedule-table">
                                <thead id="weeklyHeader"></thead>
                                <tbody id="weeklyBody"></tbody>
                            </table>
                        </div>
                        <div id="scheduleFeedback" class="feedback-message mt-2"></div>
                    </div>
                </section>

                <!-- Statistics Section -->
                <section id="teaching-display" class="dashboard-section animate-fade-in">
                    <div class="card">
                        <div class="filter-bar flex flex-wrap gap-4 mb-6 items-end">
                            <div class="form-group">
                                <label>开始日期</label>
                                <input type="date" id="teachingStartDate">
                            </div>
                            <div class="form-group">
                                <label>结束日期</label>
                                <input type="date" id="teachingEndDate">
                            </div>
                            <div class="flex gap-2">
                                <button id="teachingQueryBtn" class="btn primary-btn">
                                    <span class="material-icons-round">search</span> 查询
                                </button>
                                <button id="teachingExportBtn" class="btn secondary-btn">
                                    <span class="material-icons-round">download</span> 导出
                                </button>
                            </div>
                        </div>

                        <div id="teachingTypeStats" class="stats-grid mb-6">
                            <!-- Dynamic Stats -->
                        </div>

                        <div class="table-responsive">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>日期</th>
                                        <th>时间段</th>
                                        <th>课程类型</th>
                                        <th>学生姓名</th>
                                        <th>上课地点</th>
                                        <th>状态</th>
                                    </tr>
                                </thead>
                                <tbody id="teachingDetailsBody"></tbody>
                            </table>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="/js/api-utils.js"></script>
    <script src="/js/date-range-utils.js"></script>
    <script src="/js/schedule-types-store.js"></script>
    <script type="module" src="/js/teacher.js"></script>

    <!-- Mobile Menu Script -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const mobileBtn = document.querySelector('.mobile-menu-btn');
            const sidebar = document.querySelector('.sidebar');
            const closeBtn = document.querySelector('.sidebar-toggle-mobile');

            const toggleMenu = () => sidebar.classList.toggle('active');

            if (mobileBtn) mobileBtn.addEventListener('click', toggleMenu);
            if (closeBtn) closeBtn.addEventListener('click', toggleMenu);

            // Close sidebar when clicking outside on mobile
            document.addEventListener('click', (e) => {
                if (window.innerWidth <= 768 &&
                    sidebar.classList.contains('active') &&
                    !sidebar.contains(e.target) &&
                    !mobileBtn.contains(e.target)) {
                    sidebar.classList.remove('active');
                }
            });
        });
    </script>
</body>

</html>